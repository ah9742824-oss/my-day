<!doctype html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Ù…Ù†Ø¸Ù… Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ - Ù…ÙˆØ¯Ø±Ù†</title>
  <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@300;400;600;700&display=swap" rel="stylesheet">
  <style>
    :root{
      --bg:#f3f7fb;
      --card:#ffffff;
      --muted:#6b7280;
      --accent:#2563eb;
      --glass: rgba(255,255,255,0.6);
      --success:#10b981;
      --danger:#ef4444;
      --border:#e6edf3;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;font-family:"Cairo",sans-serif;background:linear-gradient(180deg,#f7fbff 0%,var(--bg) 100%);
      color:#0b1220;
      -webkit-font-smoothing:antialiased;
      -moz-osx-font-smoothing:grayscale;
    }

    header.app-header{
      display:flex;align-items:center;justify-content:space-between;padding:16px 20px;
      gap:12px;background:transparent;
    }
    .brand{display:flex;gap:12px;align-items:center}
    .logo{
      width:46px;height:46px;border-radius:10px;background:linear-gradient(135deg,var(--accent),#7dd3fc);display:flex;align-items:center;justify-content:center;color:white;font-weight:700;font-size:18px;box-shadow:0 6px 18px rgba(37,99,235,0.15)
    }
    h1{margin:0;font-size:20px}
    .header-actions{display:flex;gap:8px;align-items:center}

    .container{max-width:1200px;margin:8px auto;padding:12px}
    .top-controls{display:flex;gap:8px;align-items:center;justify-content:space-between;margin-bottom:12px}
    .btn{
      background:var(--card);border:1px solid var(--border);padding:8px 12px;border-radius:10px;cursor:pointer;
      box-shadow:0 4px 10px rgba(2,6,23,0.04);
    }
    .btn.primary{background:linear-gradient(90deg,var(--accent),#7dd3fc);color:white;border:none}
    .btn.ghost{background:transparent;border:1px dashed var(--border);}

    /* week grid */
    .week-wrap{background:transparent;border-radius:12px;padding:12px}
    .grid{
      display:grid;
      grid-template-columns:80px repeat(7,1fr);
      gap:8px;
      align-items:start;
    }
    .time-col{display:flex;flex-direction:column;gap:8px}
    .time-slot{
      height:56px;background:transparent;border-radius:10px;display:flex;align-items:center;justify-content:center;color:var(--muted);font-weight:600;font-size:13px
    }
    .day-col{display:flex;flex-direction:column;gap:8px}
    .day-header{background:var(--card);padding:8px;border-radius:10px;border:1px solid var(--border);text-align:center;font-weight:700}
    .stack{display:flex;flex-direction:column;gap:8px}

    .block{
      background:var(--card);border:1px solid var(--border);padding:10px;border-radius:10px;min-height:48px;cursor:pointer;position:relative;overflow:hidden;
      transition:transform .12s, box-shadow .12s;
    }
    .block:hover{transform:translateY(-4px);box-shadow:0 10px 30px rgba(2,6,23,0.06)}
    .block .time{position:absolute;left:8px;top:8px;font-size:11px;color:var(--muted)}
    .block .title{font-weight:700;text-align:right}
    .block .note{display:block;color:#334155;margin-top:8px;font-size:13px}
    .block.empty{opacity:0.6;color:var(--muted);font-weight:600;text-align:center}

    /* type colors */
    .block[data-type="university"]{border-left:6px solid #f59e0b}
    .block[data-type="exercise"]{border-left:6px solid #2563eb}
    .block[data-type="study"]{border-left:6px solid #10b981}
    .block[data-type="food"]{border-left:6px solid #ef4444}
    .block[data-type="other"]{border-left:6px solid #9ca3af}

    /* modal */
    .modal{position:fixed;inset:0;background:rgba(2,6,23,0.45);display:flex;align-items:center;justify-content:center;padding:20px;z-index:80}
    .modal-card{width:520px;background:var(--card);padding:16px;border-radius:12px;border:1px solid var(--border);box-shadow:0 8px 30px rgba(2,6,23,0.08)}
    .modal h3{margin:0 0 8px 0}
    label{display:block;margin-top:8px;font-weight:700;font-size:14px}
    input[type="text"], input[type="time"], input[type="number"], textarea, select{
      width:100%;padding:8px;border-radius:8px;border:1px solid var(--border);margin-top:6px;
    }
    textarea{resize:vertical;min-height:70px}
    .modal .actions{display:flex;gap:8px;justify-content:flex-end;margin-top:12px}
    .danger{background:var(--danger);color:white;border:none}
    .save{background:var(--accent);color:white;border:none}

    /* day view */
    .day-header-row{display:flex;gap:10px;align-items:center;justify-content:space-between;margin-bottom:12px}
    .tabs{display:flex;gap:8px;flex-wrap:wrap}
    .tab{padding:8px 12px;border-radius:10px;background:var(--card);border:1px solid var(--border);cursor:pointer}
    .tab.active{background:linear-gradient(90deg,var(--accent),#7dd3fc);color:white;border:none}
    .tab-content{background:var(--card);border:1px solid var(--border);padding:12px;border-radius:12px}

    .exercise-item{display:flex;gap:10px;align-items:center;padding:8px;border-radius:8px;border:1px solid #eef3fb;margin-bottom:8px}
    .exercise-item .meta{flex:1}
    .exercise-item .meta b{display:block}
    .exercise-item small{display:block;color:var(--muted);margin-top:6px}
    .exercise-actions{display:flex;gap:6px;align-items:center}

    .flex{display:flex;gap:8px;align-items:center}
    .muted{color:var(--muted)}

    footer.app-footer{padding:12px;text-align:center;color:var(--muted);margin-top:12px}

    /* responsive */
    @media (max-width:980px){ .grid{grid-template-columns:60px repeat(7,1fr)} .modal-card{width:92%} .time-slot{height:48px} }
    @media (max-width:700px){ .grid{grid-template-columns:50px repeat(7,1fr);overflow:auto} .time-slot{height:42px} }
  </style>
</head>
<body>
  <header class="app-header">
    <div class="brand">
      <div class="logo">A</div>
      <div>
        <h1>ÙŠÙˆÙ…ÙŠ</h1>
      </div>
    </div>

    <div class="header-actions">
      <button id="exportAllJson" class="btn">ØªÙ†Ø²ÙŠÙ„ ÙƒÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª (JSON)</button>
      <button id="clearAll" class="btn">Ù…Ø³Ø­ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª</button>
      <button id="openToday" class="btn primary">Ø§ÙØªØ­ ÙŠÙˆÙ… Ø§Ù„ÙŠÙˆÙ…</button>
    </div>
  </header>

  <main class="container">
    <div class="top-controls">
      <div class="flex">
        <select id="viewDay" class="btn">
          <option value="">Ø¹Ø±Ø¶ ÙŠÙˆÙ… (Ø§ÙØªØ­ ØµÙØ­Ø© Ø§Ù„ÙŠÙˆÙ…)</option>
        </select>
        <button id="gotoDay" class="btn">ÙØªØ­</button>
      </div>
    </div>

    <section class="week-wrap">
      <div class="grid" id="weekGrid">
        <!-- JS ÙŠØ¨Ù†ÙŠ Ø§Ù„Ø¬Ø¯ÙˆÙ„ -->
      </div>
    </section>

    <hr style="margin:18px 0;border:none;border-top:1px solid var(--border)">

    <!-- Day detail area (tabs) -->
    <section id="dayView" style="display:none">
      <div class="day-header-row">
        <div>
          <h2 id="dayTitle">ØªÙØ§ØµÙŠÙ„ Ø§Ù„ÙŠÙˆÙ…</h2>
          <div class="muted" id="daySubtitle">ØªÙØ§ØµÙŠÙ„ + Ø®Ø·Ø© Ø§Ù„ØªÙ…Ø±ÙŠÙ†</div>
        </div>
        <div class="flex">
          <button id="backToWeek" class="btn">Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„Ø£Ø³Ø¨ÙˆØ¹</button>
          <button id="downloadPdf" class="btn primary">ØªÙ†Ø²ÙŠÙ„ PDF Ù„Ù„ÙŠÙˆÙ…</button>
        </div>
      </div>

      <div class="tabs" id="tabs">
        <div class="tab active" data-tab="workout">ğŸ‹ï¸ï¸ Ø§Ù„ØªÙ…Ø§Ø±ÙŠÙ†</div>
        <div class="tab" data-tab="food">ğŸ½ Ø§Ù„ØºØ°Ø§Ø¡</div>
        <div class="tab" data-tab="university">ğŸ“ Ø§Ù„Ø¬Ø§Ù…Ø¹Ø©</div>
        <div class="tab" data-tab="tasks">ğŸ“‹ Ø§Ù„Ù…Ù‡Ø§Ù…</div>
        <div class="tab" data-tab="notes">ğŸ“ Ù…Ù„Ø§Ø­Ø¸Ø§Øª</div>
      </div>

      <div style="margin-top:12px">
        <div id="tabContent" class="tab-content">
          <!-- Ù…Ø­ØªÙˆÙ‰ Ø§Ù„ØªØ¨ÙˆÙŠØ¨ ÙŠØªØºÙŠØ± Ø¨ÙˆØ§Ø³Ø·Ø© Ø¬Ø§ÙØ§Ø³ÙƒØ±Ø¨Øª -->
        </div>
      </div>
    </section>

  </main>

  <footer class="app-footer">
Designed & Developed by : Ahmed Hany Sayed Ahmed Abdel Wahab 
&copy; 2025
</footer>

  <!-- Libraries -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

  <script>
  (function(){
    // -------- config ----------
    const DAYS = ['Ø§Ù„Ø³Ø¨Øª','Ø§Ù„Ø£Ø­Ø¯','Ø§Ù„Ø§Ø«Ù†ÙŠÙ†','Ø§Ù„Ø«Ù„Ø§Ø«Ø§Ø¡','Ø§Ù„Ø£Ø±Ø¨Ø¹Ø§Ø¡','Ø§Ù„Ø®Ù…ÙŠØ³','Ø§Ù„Ø¬Ù…Ø¹Ø©'];
    const storageKey = 'weeklyPlanner_v4';
    // grid from 01:00 for 24 hours
    const startHour = 1;
    const hoursCount = 24;
    const stepMinutes = 15; // time picker step (allow minutes)
    // initial workout plans (from your message)
    const presetWorkouts = {
      'Ø§Ù„Ø³Ø¨Øª': {
         title: 'ØµØ¯Ø± + Ø¨Ø·Ù†',
        duration: '40â€“45 Ø¯Ù‚ÙŠÙ‚Ø©',
        items: [
          {title:'Push-ups', sets:'4 Ã— 15', time:'5 Ø¯Ù‚Ø§Ø¦Ù‚', url:'https://www.youtube.com/watch?v=IODxDxX7oi4'},
          {title:'Incline Push-ups', sets:'3 Ã— 12', time:'4 Ø¯Ù‚Ø§Ø¦Ù‚', url:'https://www.youtube.com/watch?v=cfns5VDVVvk'},
          {title:'Dumbbell Chest Press', sets:'3 Ã— 15', time:'5 Ø¯Ù‚Ø§Ø¦Ù‚', url:'https://www.youtube.com/watch?v=VmB1G1K7v94'},
          {title:'Crunches + Leg raises + Plank', sets:'', time:'15 Ø¯Ù‚ÙŠÙ‚Ø©', url:'https://www.youtube.com/watch?v=0t4t3IpiEao'},
        ],
        note:'Ø±Ø§Ø­Ø© ÙˆØªÙ†Ù‚Ù„Ø§Øª: 5â€“10 Ø¯Ù‚Ø§Ø¦Ù‚'
      },
      'Ø§Ù„Ø£Ø­Ø¯': {
        title: 'Ø¸Ù‡Ø± + Ø¨Ø§ÙŠ',
        duration:'40â€“45 Ø¯Ù‚ÙŠÙ‚Ø©',
        items:[
          {title:'Pull-ups', sets:'3 Ã— Ø£Ù‚ØµÙ‰ Ø¹Ø¯Ø¯', time:'6 Ø¯Ù‚Ø§Ø¦Ù‚', url:'https://www.youtube.com/watch?v=aNUSgyWRJYA'},
          {title:'Dumbbell Rows', sets:'3 Ã— 12', time:'5 Ø¯Ù‚Ø§Ø¦Ù‚', url:'https://www.youtube.com/watch?v=roCP6wCXPqo'},
          {title:'Bicep curls', sets:'3 Ã— 15', time:'5 Ø¯Ù‚Ø§Ø¦Ù‚', url:'https://www.youtube.com/watch?v=ykJmrZ5v0Oo'},
          {title:'Concentration curl', sets:'3 Ã— 12', time:'5 Ø¯Ù‚Ø§Ø¦Ù‚', url:'https://www.youtube.com/watch?v=Jvj2wV0vOYU'},
        ],
        note:'Ø¥Ø­Ù…Ø§Ø¡ ÙˆØ±Ø§Ø­Ø©: 10â€“15 Ø¯Ù‚ÙŠÙ‚Ø©'
      },
      'Ø§Ù„Ø§Ø«Ù†ÙŠÙ†': {
        title:'Ø±Ø¬Ù„ + ÙƒØªÙ', duration:'45 Ø¯Ù‚ÙŠÙ‚Ø© ØªÙ‚Ø±ÙŠØ¨Ù‹Ø§',
        items:[
          {title:'Squats + Goblet Squat', sets:'4 Ã— 20', time:'8 Ø¯Ù‚Ø§Ø¦Ù‚', url:'https://www.youtube.com/watch?v=YaXPRqUwItQ'},
          {title:'Lunges + Calf Raises', sets:'3 Ã— 15', time:'8 Ø¯Ù‚Ø§Ø¦Ù‚', url:'https://www.youtube.com/watch?v=wrwwXE_x-pQ'},
          {title:'Dumbbell Shoulder Press + Lateral Raises', sets:'3 Ã— 15', time:'10 Ø¯Ù‚Ø§Ø¦Ù‚', url:'https://www.youtube.com/watch?v=qEwKCR5JCog'},
        ],
        note:'Ø¨Ø·Ù† Ø®ÙÙŠÙ Ø£Ùˆ ØªÙ…Ø¯Ø¯ Ø¨Ø³ÙŠØ· (5 Ø¯Ù‚Ø§Ø¦Ù‚) - Ø±Ø§Ø­Ø© ÙˆØªÙ†Ù‚Ù„Ø§Øª: 10â€“15 Ø¯Ù‚ÙŠÙ‚Ø©'
      },
      'Ø§Ù„Ø«Ù„Ø§Ø«Ø§Ø¡': {
        title:'ÙƒØ§Ø±Ø¯ÙŠÙˆ + Ø¨Ø·Ù†', duration:'30â€“35 Ø¯Ù‚ÙŠÙ‚Ø©',
        items:[
          {title:'Jumping jacks', sets:'4 Ã— 1 Ø¯Ù‚ÙŠÙ‚Ø©', time:'5 Ø¯Ù‚Ø§Ø¦Ù‚', url:'https://www.youtube.com/watch?v=iSSAk4XCsRA'},
          {title:'High knees', sets:'3 Ã— 30 Ø«Ø§Ù†ÙŠØ©', time:'3 Ø¯Ù‚Ø§Ø¦Ù‚', url:'https://www.youtube.com/watch?v=lR3cpCVBjPM'},
          {title:'Burpees', sets:'3 Ã— 10', time:'5 Ø¯Ù‚Ø§Ø¦Ù‚', url:'https://www.youtube.com/watch?v=qLBImHhCXSw'},
          {title:'Bicycle crunches + Flutter kicks + Plank', sets:'', time:'15 Ø¯Ù‚ÙŠÙ‚Ø©', url:'https://www.youtube.com/watch?v=wpRI3xBhJmo'},
        ],
        note:'Ø±Ø§Ø­Ø© Ø¨Ø³ÙŠØ·Ø©: 5 Ø¯Ù‚Ø§Ø¦Ù‚'
      },
      'Ø§Ù„Ø£Ø±Ø¨Ø¹Ø§Ø¡': {
        title:'Ø¹Ù‚Ù„Ø© + Ø¸Ù‡Ø±', duration:'35â€“40 Ø¯Ù‚ÙŠÙ‚Ø©',
        items:[
          {title:'Pull-ups', sets:'', time:'5 Ø¯Ù‚Ø§Ø¦Ù‚', url:'https://www.youtube.com/watch?v=aNUSgyWRJYA'},
          {title:'Negative pull-ups', sets:'', time:'5 Ø¯Ù‚Ø§Ø¦Ù‚', url:'https://www.youtube.com/watch?v=gbPURTSxQLY'},
          {title:'Rows (ÙˆØ²Ù† Ø®ÙÙŠÙ)', sets:'', time:'8 Ø¯Ù‚Ø§Ø¦Ù‚', url:'https://www.youtube.com/watch?v=roCP6wCXPqo'},
          {title:'Superman Hold', sets:'3 Ã— 30Ø«', time:'5 Ø¯Ù‚Ø§Ø¦Ù‚', url:'https://www.youtube.com/watch?v=z6PJMT2y8GQ'},
        ],
        note:'Ø¥Ø­Ù…Ø§Ø¡ ÙˆØ±Ø§Ø­Ø©: 10â€“15 Ø¯Ù‚ÙŠÙ‚Ø©'
      },
      'Ø§Ù„Ø®Ù…ÙŠØ³': {
        title:'Ø¬Ø³Ù… ÙƒØ§Ù…Ù„', duration:'35â€“40 Ø¯Ù‚ÙŠÙ‚Ø©',
        items:[
          {title:'Push-ups', sets:'3 Ã— 15', time:'5 Ø¯Ù‚Ø§Ø¦Ù‚', url:'https://www.youtube.com/watch?v=IODxDxX7oi4'},
          {title:'Squats', sets:'4 Ã— 20', time:'8 Ø¯Ù‚Ø§Ø¦Ù‚', url:'https://www.youtube.com/watch?v=YaXPRqUwItQ'},
          {title:'Pull-ups', sets:'3 Ã— 5â€“10', time:'5 Ø¯Ù‚Ø§Ø¦Ù‚', url:'https://www.youtube.com/watch?v=aNUSgyWRJYA'},
          {title:'Dumbbell Press', sets:'3 Ã— 15', time:'5 Ø¯Ù‚Ø§Ø¦Ù‚', url:'https://www.youtube.com/watch?v=VmB1G1K7v94'},
        ],
        note:'Plank: 3 Ã— 1 Ø¯Ù‚ÙŠÙ‚Ø© (6 Ø¯Ù‚Ø§Ø¦Ù‚) - Ø±Ø§Ø­Ø© Ø¨ÙŠÙ† Ø§Ù„Ø¬ÙˆÙ„Ø§Øª: 10â€“15 Ø¯Ù‚ÙŠÙ‚Ø©'
      },
      'Ø§Ù„Ø¬Ù…Ø¹Ø©': {
        title:'Ø±Ø§Ø­Ø© / Ø¥Ø·Ø§Ù„Ø©', duration:'ÙˆÙ‚Øª Ø­Ø±',
        items:[
          {title:'Ø§Ø³ØªØ±Ø®Ø§Ø¡ ÙˆØªÙ…Ø¯Ø¯', sets:'', time:'20-30 Ø¯Ù‚ÙŠÙ‚Ø©', url:''}
        ],
        note:'ÙŠÙˆÙ… Ø±Ø§Ø­Ø© â€” Ø¬Ù„Ø³Ø© ØªÙ…Ø¯Ø¯ Ø®ÙÙŠÙØ© Ø£Ùˆ Ù…Ø´ÙŠ'
      }
    };

    // default food plan
    const defaultFood = [
      {meal:'Ø§Ù„ÙØ·ÙˆØ±', content:'2 Ø¨ÙŠØ¶ + Ø®Ø¨Ø² Ø¨Ù„Ø¯ÙŠ + Ø®ÙŠØ§Ø± / Ø·Ù…Ø§Ø·Ù…'},
      {meal:'Ø³Ù†Ø§Ùƒ 1', content:'Ø«Ù…Ø±Ø© Ù…ÙˆØ² Ø£Ùˆ ØªÙØ§Ø­Ø©'},
      {meal:'Ø§Ù„ØºØ¯Ø§Ø¡', content:'Ø¹Ø¯Ø³ Ø£Ùˆ ÙÙˆÙ„ + Ø¨ÙŠØ¶Ø© + Ø£Ø±Ø² Ø£Ùˆ Ø®Ø¨Ø² Ø¨Ù„Ø¯ÙŠ'},
      {meal:'Ø³Ù†Ø§Ùƒ 2', content:'Ø¹Ù„Ø¨Ø© Ø²Ø¨Ø§Ø¯ÙŠ Ø£Ùˆ Ø¨ÙŠØ¶Ø©'},
      {meal:'Ø§Ù„Ø¹Ø´Ø§Ø¡', content:'Ø¬Ø¨Ù†Ø© Ù‚Ø±ÙŠØ´ Ø£Ùˆ Ø¨ÙŠØ¶Ø© + Ø®Ø¨Ø² + Ø®ÙŠØ§Ø±'}
    ];

    // ---------- helpers ----------
    function loadData(){ try{ return JSON.parse(localStorage.getItem(storageKey) || '{}'); }catch(e){ return {}; } }
    function saveData(d){ localStorage.setItem(storageKey, JSON.stringify(d)); }
    function uid(){ return Date.now().toString(36) + Math.random().toString(36).slice(2,8); }

    // Format hour: "01:00"
    function pad(v){ return v.toString().padStart(2,'0'); }
    function fmtHour(h,min=0){ return pad(h) + ':' + pad(min); }

    // build week grid DOM
    const grid = document.getElementById('weekGrid');
    const viewDaySelect = document.getElementById('viewDay');

    function buildWeek(){
      grid.innerHTML = '';
      // time col header
      const timeColTop = document.createElement('div'); timeColTop.className='time-col';
      const emptyTop = document.createElement('div'); emptyTop.style.height='56px'; timeColTop.appendChild(emptyTop);
      for(let i=0;i<hoursCount;i++){
        const hour = (startHour + i) % 24;
        const label = document.createElement('div');
        label.className='time-slot';
        const ampm = hour<12? 'Øµ' : 'Ù…';
        const hh=((hour+11)%12 +1);
        label.textContent = pad(hh) + ':00 ' + ampm;
        timeColTop.appendChild(label);
      }
      grid.appendChild(timeColTop);

      // days
      DAYS.forEach(day=>{
        const col = document.createElement('div'); col.className='day-col';
        const header = document.createElement('div'); header.className='day-header';
        header.innerHTML = `<div style="display:flex;justify-content:space-between;align-items:center"><div>${day}</div><div style="font-size:12px" class="muted">${presetWorkouts[day]?.title||''}</div></div>`;
        col.appendChild(header);

        const stack = document.createElement('div'); stack.className='stack';

        for(let i=0;i<hoursCount;i++){
          const hour = (startHour + i) % 24;
          const block = document.createElement('div'); block.className='block empty';
          block.dataset.day = day; block.dataset.time = fmtHour(hour,0);
          block.innerHTML = `<span class="time">${fmtHour(hour,0)}</span><span class="title">Ø§Ø¶ØºØ· Ù„Ø¥Ø¶Ø§ÙØ© Ø­Ø¯Ø«</span>`;
          // load saved event if exists for that exact hour slot (we support minute-level but for grid show top-of-hour)
          const data = loadData();
          const events = data.events || {};
          // find any event that overlaps this time for this day
          const found = Object.values(events).find(ev=>{
            return ev.day===day && timeOverlap(ev.start, ev.end, fmtHour(hour,0));
          });
          if(found){
            block.classList.remove('empty');
            block.dataset.type = found.type || 'other';
            block.querySelector('.title').textContent = found.title || 'Ø­Ø¯Ø«';
            if(found.note){
              const n = document.createElement('span'); n.className='note'; n.textContent = found.note; block.appendChild(n);
            }
            // small duration label
            const dur = document.createElement('span'); dur.style.position='absolute'; dur.style.right='8px'; dur.style.top='8px'; dur.style.fontSize='11px'; dur.style.color='var(--muted)';
            dur.textContent = found.start + (found.end? ' - '+found.end : '');
            block.appendChild(dur);
          }

          block.addEventListener('click', ()=>openEventModal(day, fmtHour(hour,0)));
          stack.appendChild(block);
        }

        col.appendChild(stack);
        grid.appendChild(col);
      });

      // populate day select
      viewDaySelect.innerHTML = '<option value="">Ø§Ø®ØªØ± ÙŠÙˆÙ…</option>';
      DAYS.forEach(d=>{ const opt=document.createElement('option'); opt.value=d; opt.textContent=d; viewDaySelect.appendChild(opt); });
    }

    // time overlap check (if time t0 lies between start and end (inclusive start, exclusive end))
    function timeToMinutes(t){ const [hh,mm]=t.split(':').map(Number); return hh*60+mm; }
    function timeOverlap(start,end, check){
      const s=timeToMinutes(start); const e=timeToMinutes(end||start);
      const c=timeToMinutes(check);
      // if end<start assume same day but we handle always within 24h; treat inclusive start exclusive end
      return (c >= s && c < e);
    }

    // open add/edit modal
    function openEventModal(day, defaultTime){
      const data = loadData();
      const events = data.events || {};

      // create modal
      const modal = document.createElement('div'); modal.className='modal';
      const card = document.createElement('div'); card.className='modal-card';
      card.innerHTML = `
        <h3>Ø¥Ø¶Ø§ÙØ© / ØªØ¹Ø¯ÙŠÙ„ Ø­Ø¯Ø«</h3>
        <label>Ø§Ù„ÙŠÙˆÙ…</label>
        <input type="text" id="m_day" readonly value="${day}">
        <div class="row" style="display:flex;gap:8px;margin-top:8px">
          <div style="flex:1">
            <label>Ø¨Ø¯Ø§ÙŠØ©</label>
            <input id="m_start" type="time" step="${stepMinutes*60}" value="${defaultTime}">
          </div>
          <div style="flex:1">
            <label>Ù†Ù‡Ø§ÙŠØ©</label>
            <input id="m_end" type="time" step="${stepMinutes*60}" value="${defaultTime}">
          </div>
        </div>
        <label>Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ø­Ø¯Ø«</label>
        <input id="m_title" type="text" placeholder="Ù…Ø«Ø§Ù„: Ù…Ø­Ø§Ø¶Ø±Ø©ØŒ ØªÙ…Ø±ÙŠÙ† ...">
        <label>Ù†ÙˆØ¹</label>
        <select id="m_type">
          <option value="">Ø¹Ø§Ù…</option>
          <option value="university">Ø¬Ø§Ù…Ø¹Ø©</option>
          <option value="exercise">ØªÙ…Ø±ÙŠÙ†</option>
          <option value="study">Ù…Ø°Ø§ÙƒØ±Ø©</option>
          <option value="food">ØºØ°Ø§Ø¡</option>
          <option value="other">Ø£Ø®Ø±Ù‰</option>
        </select>
        <label>Ù…Ù„Ø§Ø­Ø¸Ø§Øª / Ø±Ø§Ø¨Ø·</label>
        <textarea id="m_note" placeholder="Ù…Ø«Ù„ Ø±Ø§Ø¨Ø· Ø§Ù„ÙŠÙˆØªÙŠÙˆØ¨ Ø£Ùˆ ØªÙØ§ØµÙŠÙ„"></textarea>
        <div class="actions">
          <button id="delEvt" class="btn danger">Ø­Ø°Ù</button>
          <button id="saveEvt" class="btn save">Ø­ÙØ¸</button>
        </div>
      `;
      modal.appendChild(card);
      document.body.appendChild(modal);

      // When saving: create event id and store
      card.querySelector('#saveEvt').addEventListener('click', ()=>{
        const start = card.querySelector('#m_start').value;
        const end = card.querySelector('#m_end').value || start;
        const title = card.querySelector('#m_title').value.trim();
        const type = card.querySelector('#m_type').value || 'other';
        const note = card.querySelector('#m_note').value.trim();
        if(!title){ alert('Ø§ÙƒØªØ¨ Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ø­Ø¯Ø«'); return; }
        // create event id
        const id = uid();
        events[id] = {id, day, start, end, title, type, note};
        data.events = events;
        saveData(data);
        document.body.removeChild(modal);
        buildWeek();
      });

      card.querySelector('#delEvt').addEventListener('click', ()=>{
        // find any event overlapping and delete (simple behavior: delete the first found)
        const s = card.querySelector('#m_start').value;
        const foundId = Object.keys(events).find(k => events[k].day===day && events[k].start===s);
        if(foundId){
          if(!confirm('Ø­Ø°Ù Ø§Ù„Ø­Ø¯Ø«ØŸ')) return;
          delete events[foundId];
          data.events = events; saveData(data);
        }
        document.body.removeChild(modal); buildWeek();
      });

      modal.addEventListener('click', (e)=>{ if(e.target===modal) document.body.removeChild(modal); });
    }

    // --------- Day view (tabs + content) ----------
    const dayView = document.getElementById('dayView');
    const dayTitle = document.getElementById('dayTitle');
    const daySubtitle = document.getElementById('daySubtitle');
    const tabs = document.getElementById('tabs');
    const tabContent = document.getElementById('tabContent');
    let currentDay = null;

    // open day
    function openDay(day){
      currentDay = day;
      document.getElementById('viewDay').value = day;
      dayTitle.textContent = `ØªÙØ§ØµÙŠÙ„ - ${day}`;
      daySubtitle.textContent = presetWorkouts[day]?.title || '';
      dayView.style.display = 'block';
      // hide week
      window.scrollTo({top:0,behavior:'smooth'});
      renderTab('workout');
      // set active tab UI
      Array.from(tabs.querySelectorAll('.tab')).forEach(t=> t.classList.toggle('active', t.dataset.tab==='workout'));
      document.getElementById('weekGrid').scrollIntoView({behavior:'smooth'});
      // hide week visually (we keep it but scroll)
      document.querySelector('.week-wrap').style.display = 'none';
    }

    document.getElementById('gotoDay').addEventListener('click', ()=>{
      const d = document.getElementById('viewDay').value;
      if(d) openDay(d);
    });
    document.getElementById('backToWeek').addEventListener('click', ()=>{
      dayView.style.display = 'none';
      document.querySelector('.week-wrap').style.display = '';
      currentDay = null;
    });
    document.getElementById('openToday').addEventListener('click', ()=>{
      const today = new Date();
      const dayIndex = (today.getDay()+6) % 7; // convert Sunday=0 to Arabic mapping starting Saturday
      openDay(DAYS[dayIndex]);
    });

    tabs.addEventListener('click', (e)=>{
      const t = e.target.closest('.tab');
      if(!t) return;
      Array.from(tabs.querySelectorAll('.tab')).forEach(x=>x.classList.remove('active'));
      t.classList.add('active');
      renderTab(t.dataset.tab);
    });

    function renderTab(tab){
      if(!currentDay) return;
      tabContent.innerHTML = '';
      if(tab==='workout'){
        renderWorkoutTab();
      } else if(tab==='food'){
        renderFoodTab();
      } else if(tab==='university'){
        renderUniversityTab();
      } else if(tab==='tasks'){
        renderTasksTab();
      } else if(tab==='notes'){
        renderNotesTab();
      }
    }

    // -------- Workout tab ----------
    function renderWorkoutTab(){
      const d = loadData();
      const dayKey = currentDay;
      // get saved custom workouts if any
      const saved = d.workouts && d.workouts[dayKey] ? d.workouts[dayKey] : null;
      const plan = saved || presetWorkouts[dayKey] || {title:'ØªÙ…Ø§Ø±ÙŠÙ†', items:[], note:''};

      const header = document.createElement('div'); header.style.display='flex'; header.style.justifyContent='space-between'; header.style.alignItems='center';
      const left = document.createElement('div'); left.innerHTML = `<h3 style="margin:0">${plan.title || 'Ø®Ø·Ø© Ø§Ù„ØªÙ…Ø±ÙŠÙ†'}</h3><div class="muted">${plan.duration || ''}</div>`;
      const right = document.createElement('div');
      right.innerHTML = `<button id="addExercise" class="btn">Ø£Ø¶Ù ØªÙ…Ø±ÙŠÙ†</button> <button id="saveWorkout" class="btn primary">Ø­ÙØ¸ Ø§Ù„Ø®Ø·Ø©</button>`;
      header.appendChild(right); header.insertBefore(left, right);
      tabContent.appendChild(header);

      if(plan.note){
        const p = document.createElement('div'); p.className='muted'; p.style.marginTop='8px'; p.textContent = plan.note; tabContent.appendChild(p);
      }

      const list = document.createElement('div'); list.style.marginTop='12px';
      tabContent.appendChild(list);

      function renderList(){
        list.innerHTML = '';
        (plan.items || []).forEach((ex, idx)=>{
          const it = document.createElement('div'); it.className='exercise-item';
          const cb = document.createElement('input'); cb.type='checkbox'; cb.style.transform='scale(1.2)';
          // checked state from saved progress
          const progress = d.progress || {};
          const checked = progress[dayKey] && progress[dayKey][ex.title];
          cb.checked = !!checked;

          cb.addEventListener('change', ()=>{
            const p = loadData();
            p.progress = p.progress || {};
            p.progress[dayKey] = p.progress[dayKey] || {};
            p.progress[dayKey][ex.title] = cb.checked;
            saveData(p);
          });

          const meta = document.createElement('div'); meta.className='meta';
          const title = document.createElement('b'); title.textContent = ex.title + (ex.sets? (' â€” '+ex.sets) : '');
          const small = document.createElement('small'); small.className='muted';
          small.innerHTML = `${ex.time || ''} ${ex.url? (' â€” <a href="'+ex.url+'" target="_blank">ÙÙŠØ¯ÙŠÙˆ</a>') : ''}`;
          meta.appendChild(title); meta.appendChild(small);

          const actions = document.createElement('div'); actions.className='exercise-actions';
          const editBtn = document.createElement('button'); editBtn.className='btn'; editBtn.textContent='ØªØ¹Ø¯ÙŠÙ„';
          const delBtn = document.createElement('button'); delBtn.className='btn'; delBtn.textContent='Ø­Ø°Ù';
          actions.appendChild(editBtn); actions.appendChild(delBtn);

          editBtn.addEventListener('click', ()=>openEditExercise(idx));
          delBtn.addEventListener('click', ()=>{
            if(confirm('Ø­Ø°Ù Ø§Ù„ØªÙ…Ø±ÙŠÙ†ØŸ')){
              plan.items.splice(idx,1);
              // also remove progress
              const p = loadData(); if(p.progress && p.progress[dayKey]) delete p.progress[dayKey][ex.title]; saveData(p);
              renderList();
            }
          });

          it.appendChild(cb); it.appendChild(meta); it.appendChild(actions);
          list.appendChild(it);
        });
      }
      renderList();

      document.getElementById('addExercise').addEventListener('click', ()=>{
        // insert a new editable row
        openExerciseEditor(null);
      });

      document.getElementById('saveWorkout').addEventListener('click', ()=>{
        const p = loadData();
        p.workouts = p.workouts || {};
        p.workouts[dayKey] = plan;
        saveData(p);
        alert('ØªÙ… Ø­ÙØ¸ Ø®Ø·Ø© Ø§Ù„ØªÙ…Ø±ÙŠÙ† Ù„Ù‡Ø°Ø§ Ø§Ù„ÙŠÙˆÙ….');
      });

      // open editor for existing index
      function openEditExercise(idx){
        openExerciseEditor(idx);
      }

      function openExerciseEditor(idx){
        // modal card
        const modal = document.createElement('div'); modal.className='modal';
        const card = document.createElement('div'); card.className='modal-card';
        card.innerHTML = `<h3>${idx===null? 'Ø¥Ø¶Ø§ÙØ© ØªÙ…Ø±ÙŠÙ†' : 'ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„ØªÙ…Ø±ÙŠÙ†'}</h3>
          <label>Ø§Ø³Ù… Ø§Ù„ØªÙ…Ø±ÙŠÙ†</label><input id="ex_title" type="text" value="${idx!==null ? (plan.items[idx].title || '') : ''}">
          <label>Ø§Ù„Ø¬ÙˆÙ„Ø§Øª / Ø§Ù„ÙˆØµÙ</label><input id="ex_sets" type="text" value="${idx!==null ? (plan.items[idx].sets || '') : ''}">
          <label>Ø§Ù„ØªÙ‚Ø¯ÙŠØ± Ø§Ù„Ø²Ù…Ù†ÙŠ</label><input id="ex_time" type="text" value="${idx!==null ? (plan.items[idx].time || '') : ''}">
          <label>Ø±Ø§Ø¨Ø· Ø§Ù„ÙÙŠØ¯ÙŠÙˆ (ÙŠÙˆØªÙŠÙˆØ¨)</label><input id="ex_url" type="text" value="${idx!==null ? (plan.items[idx].url || '') : ''}">
          <div class="actions"><button id="cancelBtn" class="btn">Ø¥Ù„ØºØ§Ø¡</button><button id="saveBtn" class="btn primary">Ø­ÙØ¸</button></div>
        `;
        modal.appendChild(card); document.body.appendChild(modal);
        card.querySelector('#cancelBtn').addEventListener('click', ()=>document.body.removeChild(modal));
        card.querySelector('#saveBtn').addEventListener('click', ()=>{
          const t = card.querySelector('#ex_title').value.trim();
          if(!t){ alert('Ø§ÙƒØªØ¨ Ø§Ø³Ù… Ø§Ù„ØªÙ…Ø±ÙŠÙ†'); return; }
          const s = card.querySelector('#ex_sets').value.trim();
          const ti = card.querySelector('#ex_time').value.trim();
          const u = card.querySelector('#ex_url').value.trim();
          if(idx===null){
            plan.items.push({title:t, sets:s, time:ti, url:u});
          } else {
            plan.items[idx] = {title:t, sets:s, time:ti, url:u};
          }
          document.body.removeChild(modal);
          renderList();
        });
        modal.addEventListener('click',(e)=>{ if(e.target===modal) document.body.removeChild(modal); });
      }
    }

    // -------- Food tab ----------
    function renderFoodTab(){
      const d = loadData();
      const dayKey = currentDay;
      const saved = (d.food && d.food[dayKey]) ? d.food[dayKey] : defaultFood;
      const header = document.createElement('div'); header.style.display='flex'; header.style.justifyContent='space-between';
      header.innerHTML = `<div><h3 style="margin:0">Ø¬Ø¯ÙˆÙ„ Ø§Ù„ØºØ°Ø§Ø¡</h3><div class="muted">Ø®Ø·Ø© ØºØ°Ø§Ø¦ÙŠØ© Ø§Ù‚ØªØµØ§Ø¯ÙŠØ©</div></div><div><button id="saveFood" class="btn primary">Ø­ÙØ¸</button></div>`;
      tabContent.appendChild(header);
      const list = document.createElement('div'); list.style.marginTop='12px';
      saved.forEach((m,idx)=>{
        const row = document.createElement('div'); row.className='exercise-item';
        const meal = document.createElement('div'); meal.style.flex='1';
        meal.innerHTML = `<b>${m.meal}</b><small class="muted">${m.content}</small>`;
        const edit = document.createElement('button'); edit.className='btn'; edit.textContent='ØªØ¹Ø¯ÙŠÙ„';
        edit.addEventListener('click', ()=> {
          const nm = prompt('Ù†Øµ Ø§Ù„ÙˆØ¬Ø¨Ø©:', m.content);
          if(nm!==null){ m.content = nm; renderFoodTab(); }
        });
        row.appendChild(meal); row.appendChild(edit);
        list.appendChild(row);
      });
      tabContent.appendChild(list);
      document.getElementById('saveFood').addEventListener('click', ()=>{
        const p = loadData(); p.food = p.food || {}; p.food[dayKey] = saved; saveData(p); alert('ØªÙ… Ø­ÙØ¸ Ø§Ù„ØºØ°Ø§Ø¡');
        renderTab('food');
      });
    }

    // -------- University tab ----------
    function renderUniversityTab(){
      const d = loadData();
      const dayKey = currentDay;
      const items = (d.university && d.university[dayKey]) ? d.university[dayKey] : [];
      const header = document.createElement('div'); header.style.display='flex'; header.style.justifyContent='space-between';
      header.innerHTML = `<div><h3 style="margin:0">Ø§Ù„Ø¬Ø§Ù…Ø¹Ø© / Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ù…Ø­Ø§Ø¶Ø±Ø§Øª</h3><div class="muted">Ø£Ø¶Ù Ù…Ø­Ø§Ø¶Ø±Ø§Øª Ø§Ù„ÙŠÙˆÙ… Ù…Ø¹ Ø§Ù„ÙˆÙ‚Øª</div></div><div><button id="addClass" class="btn">Ø£Ø¶Ù Ù…Ø­Ø§Ø¶Ø±Ø©</button></div>`;
      tabContent.appendChild(header);
      const list = document.createElement('div'); list.style.marginTop='12px';
      items.forEach((it,idx)=>{
        const row = document.createElement('div'); row.className='exercise-item';
        const meta = document.createElement('div'); meta.style.flex='1';
        meta.innerHTML = `<b>${it.title}</b><small class="muted">${it.start} - ${it.end} ${it.location?(' â€” '+it.location):''}</small>`;
        const del = document.createElement('button'); del.className='btn'; del.textContent='Ø­Ø°Ù';
        del.addEventListener('click', ()=>{ if(confirm('Ø­Ø°Ù Ø§Ù„Ù…Ø­Ø§Ø¶Ø±Ø©ØŸ')){ items.splice(idx,1); const p=loadData(); p.university = p.university||{}; p.university[dayKey]=items; saveData(p); renderUniversityTab(); }});
        row.appendChild(meta); row.appendChild(del);
        list.appendChild(row);
      });
      tabContent.appendChild(list);

      document.getElementById('addClass').addEventListener('click', ()=>{
        const title = prompt('Ø§Ø³Ù… Ø§Ù„Ù…Ø§Ø¯Ø©:'); if(!title) return;
        const start = prompt('Ø¨Ø¯Ø§ÙŠØ© (Ù…Ø«Ù„ 09:00):','09:00') || '';
        const end = prompt('Ù†Ù‡Ø§ÙŠØ© (Ù…Ø«Ù„ 10:30):','10:30') || '';
        const loc = prompt('Ø§Ù„Ù…ÙƒØ§Ù† (Ø§Ø®ØªÙŠØ§Ø±ÙŠ):','') || '';
        items.push({title,start,end,location:loc});
        const p = loadData(); p.university = p.university || {}; p.university[dayKey]=items; saveData(p);
        renderUniversityTab();
      });
    }

    // -------- Tasks tab ----------
    function renderTasksTab(){
      const d = loadData();
      const dayKey = currentDay;
      const items = (d.tasks && d.tasks[dayKey]) ? d.tasks[dayKey] : [];
      const header = document.createElement('div'); header.style.display='flex'; header.style.justifyContent='space-between';
      header.innerHTML = `<div><h3 style="margin:0">Ø§Ù„Ù…Ù‡Ø§Ù…</h3><div class="muted">Ø£Ø¶Ù Ù…Ù‡Ø§Ù… Ø§Ù„ÙŠÙˆÙ… ÙˆØªØ¹Ù„ÙŠÙ… Ø£Ù†Ù‡Ø§ Ø§Ù†ØªÙ‡Øª</div></div><div><button id="addTask" class="btn">Ø£Ø¶Ù Ù…Ù‡Ù…Ø©</button></div>`;
      tabContent.appendChild(header);
      const list = document.createElement('div'); list.style.marginTop='12px';
      items.forEach((t,idx)=>{
        const row = document.createElement('div'); row.className='exercise-item';
        const cb = document.createElement('input'); cb.type='checkbox'; cb.checked = !!t.done;
        cb.addEventListener('change', ()=>{ t.done = cb.checked; const p = loadData(); p.tasks = p.tasks || {}; p.tasks[dayKey] = items; saveData(p); renderTasksTab(); });
        const meta = document.createElement('div'); meta.style.flex='1'; meta.innerHTML = `<b>${t.title}</b><small class="muted">${t.time||''}</small>`;
        const del = document.createElement('button'); del.className='btn'; del.textContent='Ø­Ø°Ù';
        del.addEventListener('click', ()=>{ if(confirm('Ø­Ø°Ù Ø§Ù„Ù…Ù‡Ù…Ø©ØŸ')){ items.splice(idx,1); const p=loadData(); p.tasks = p.tasks || {}; p.tasks[dayKey]=items; saveData(p); renderTasksTab(); }});
        row.appendChild(cb); row.appendChild(meta); row.appendChild(del);
        list.appendChild(row);
      });
      tabContent.appendChild(list);
      document.getElementById('addTask').addEventListener('click', ()=>{
        const title = prompt('Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ù…Ù‡Ù…Ø©:'); if(!title) return;
        const time = prompt('Ø§Ù„ÙˆÙ‚Øª (Ø§Ø®ØªÙŠØ§Ø±ÙŠ Ù…Ø«Ù„ 14:30):','');
        items.push({title,time,done:false});
        const p = loadData(); p.tasks = p.tasks || {}; p.tasks[dayKey] = items; saveData(p);
        renderTasksTab();
      });
    }

    // -------- Notes tab ----------
    function renderNotesTab(){
      const d = loadData(); const dayKey = currentDay;
      const note = (d.notes && d.notes[dayKey]) ? d.notes[dayKey] : '';
      const ta = document.createElement('textarea'); ta.style.width='100%'; ta.style.minHeight='240px'; ta.value = note;
      tabContent.appendChild(ta);
      const save = document.createElement('div'); save.style.marginTop='8px'; save.innerHTML = '<button class="btn primary">Ø­ÙØ¸ Ø§Ù„Ù…Ù„Ø§Ø­Ø¸Ø©</button>';
      tabContent.appendChild(save);
      save.querySelector('button').addEventListener('click', ()=>{ const p=loadData(); p.notes = p.notes || {}; p.notes[dayKey]=ta.value; saveData(p); alert('ØªÙ… Ø­ÙØ¸ Ø§Ù„Ù…Ù„Ø§Ø­Ø¸Ø©'); });
    }

    // -------- PDF export for current day ----------
    document.getElementById('downloadPdf').addEventListener('click', async ()=>{
      if(!currentDay) return alert('Ø§ÙØªØ­ ÙŠÙˆÙ… Ø£ÙˆÙ„Ø§Ù‹');
      const node = document.getElementById('tabContent');
      // clone to simplify layout
      const clone = node.cloneNode(true);
      clone.style.width = '800px';
      clone.style.background = '#fff';
      clone.style.padding = '20px';
      document.body.appendChild(clone);
      try{
        const canvas = await html2canvas(clone, {scale:2});
        const imgData = canvas.toDataURL('image/png');
        const { jsPDF } = window.jspdf;
        const pdf = new jsPDF('p','mm','a4');
        const pageWidth = pdf.internal.pageSize.getWidth();
        const imgProps = pdf.getImageProperties(imgData);
        const pdfWidth = pageWidth - 20;
        const pdfHeight = (imgProps.height * pdfWidth) / imgProps.width;
        pdf.addImage(imgData,'PNG',10,10,pdfWidth,pdfHeight);
        pdf.save(`${currentDay}_plan.pdf`);
      }catch(e){
        alert('ÙØ´Ù„ Ø¥Ù†Ø´Ø§Ø¡ PDF: ' + e.message);
      }
      document.body.removeChild(clone);
    });

    // Export all JSON
    document.getElementById('exportAllJson').addEventListener('click', ()=>{
      const data = loadData();
      const blob = new Blob([JSON.stringify(data, null, 2)], {type:'application/json'});
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a'); a.href=url; a.download = 'planner_data.json'; a.click(); URL.revokeObjectURL(url);
    });

    // clear all
    document.getElementById('clearAll').addEventListener('click', ()=>{
      if(confirm('Ù…Ø³Ø­ ÙƒÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ù† Ø§Ù„Ù…ØªØµÙØ­ØŸ')){ localStorage.removeItem(storageKey); buildWeek(); alert('ØªÙ… Ø§Ù„Ù…Ø³Ø­'); }
    });

    // open day if url param
    function tryOpenFromURL(){
      const params = new URLSearchParams(location.search);
      const day = params.get('day');
      if(day && DAYS.includes(day)) openDay(day);
    }

    // init
    buildWeek();
    tryOpenFromURL();

    // on clicking any existing event show details and option to edit more precisely
    // (handled in modal when clicking block)
  })();
  </script>
</body>

</html>
